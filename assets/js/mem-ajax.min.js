function mem_validate_payment_form(){var a=jQuery('input[type="radio"][name="mem_payment_amount"]:checked');if(0===a.length)return{msg:mem_vars.no_payment_amount};if("part_payment"===a.val()){var b=jQuery("#part-payment").val();if(!jQuery.isNumeric(b))return{type:"error",field:"part-payment",msg:mem_vars.no_payment_amount}}return mem_vars.require_privacy&&!jQuery("#mem-agree-privacy-policy").is(":checked")?{type:"error",field:"mem-agree-privacy-policy",msg:mem_vars.privacy_error}:mem_vars.require_terms&&!jQuery("#mem-agree-terms").is(":checked")?{type:"error",field:"mem-agree-terms",msg:mem_vars.terms_error}:{type:"success"}}function mem_load_gateway(a){jQuery(".mem-payment-ajax").show(),jQuery("#mem_payment_form_wrap").html('<img src="'+mem_vars.ajax_loader+'"/>');var b=mem_vars.ajaxurl;b+=b.indexOf("?")>0?"&":"?",b=b+"payment-mode="+a,jQuery.post(b,{action:"mem_load_gateway",mem_payment_mode:a},function(a){jQuery("#mem_payment_form_wrap").html(a),jQuery(".mem-no-js").hide(),jQuery(".mem-payment-ajax").hide()})}var mem_vars;jQuery(document).ready(function(a){var b=a(".mem_datepicker");if(b.length>0){var c=mem_vars.date_format,d=mem_vars.first_day;b.datepicker({dateFormat:c,altfield:"#_mem_event_date",altformat:"yy-mm-dd",firstday:d,changeyear:!0,changemonth:!0})}a(document).on("click",".mem-scroller",function(b){b.preventDefault();var c=a(this).attr("href");a("html, body").animate({scrollTop:a(c).offset().top},500)}),a("select#mem-gateway, input.mem-gateway").change(function(){var b=a("#mem-gateway option:selected, input.mem-gateway:checked").val();return"0"!==b&&(mem_load_gateway(b),!1)}),"1"===mem_vars.is_payment&&a("select#mem-gateway, input.mem-gateway").length&&setTimeout(function(){mem_load_gateway(mem_vars.default_gateway)},200),a(document.body).on("click","#mem-payment-part",function(){a("#mem-payment-custom").show("fast")}),a(document.body).on("click","#mem-payment-deposit, #mem-payment-balance",function(){a("#mem-payment-custom").hide("fast")}),a(document).on("click","#mem_payment_form #mem_payment_submit input[type=submit]",function(b){var c=document.getElementById("mem_payment_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(mem_vars.payment_loading),a(this).prop("disabled",!0),a(this).after('<span class="mem-payment-ajax"><i class="mem-icon-spinner mem-icon-spin"></i></span>');var d=mem_validate_payment_form(c);"success"===d.type?(a(c).find(".mem-alert").hide("fast"),a(c).find(".error").removeClass("error"),a(c).submit()):(a(c).find(".mem-alert").show("fast"),a(c).find(".mem-alert").text(d.msg),d.field&&a("#"+d.field).addClass("error"),a(this).val(mem_vars.complete_payment),a(this).prop("disabled",!1))}}),a(document).on("click","#mem_playlist_form #playlist_entry_submit",function(b){var c=document.getElementById("mem_playlist_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(mem_vars.submit_playlist_loading),a(this).prop("disabled",!0),a("#mem_playlist_form_fields").addClass("mem_mute"),a(this).after(' <span id="mem-loading" class="mem-loader"><img src="'+mem_vars.ajax_loader+'" /></span>'),a("input").removeClass("error");var d=a("#mem_playlist_form"),e=a("#mem_playlist_form").serialize();d.find(".mem-alert").hide("fast"),a.ajax({type:"POST",dataType:"json",data:e,url:mem_vars.ajaxurl,success:function(b){b.error?(d.find(".mem-alert-error").show("fast"),d.find(".mem-alert-error").html(b.error),d.find("#"+b.field).addClass("error"),d.find("#"+b.field).focus()):(a("#mem_artist").val(""),a("#mem_song").val(""),a("#mem_notes").val(""),a("#mem_artist").focus(),a("#playlist-entries").hasClass("mem-hidden")&&a("#playlist-entries").removeClass("mem-hidden"),d.find(".mem-alert-success").show("fast").delay(3e3).hide("fast"),d.find(".mem-alert-success").html(mem_vars.playlist_updated),a("#playlist-entries").append(b.data.row_data),b.data.closed?window.location.href=mem_vars.playlist_page:(a(".song-count").text(b.data.songs),a(".playlist-length").text(b.data.length),0!==b.data.total&&a(".view_current_playlist").hasClass("mem-hidden")&&a(".view_current_playlist").removeClass("mem-hidden"))),a("#playlist_entry_submit").prop("disabled",!1),a("#mem_playlist_form_fields").find("#mem-loading").remove(),a("#playlist_entry_submit").val(mem_vars.submit_playlist),a("#mem_playlist_form_fields").removeClass("mem_mute")}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}}),a(document).on("click",".playlist-delete-entry",function(){var b=a(this).data("event"),c=a(this).data("entry"),d=".mem-playlist-entry-"+c,e={event_id:b,song_id:c,action:"mem_remove_playlist_entry"};a.ajax({type:"POST",dataType:"json",data:e,url:mem_vars.ajaxurl,beforeSend:function(){a("#playlist-entries").addClass("mem_mute"),a(d).addClass("mem_playlist_removing")},complete:function(){a("#playlist-entries").removeClass("mem_mute")},success:function(b){b.success&&(a(d).remove(),b.data.count>0?(a(".song-count").text(b.data.songs),a(".playlist-length").text(b.data.length)):(a("#playlist-entries").addClass("mem-hidden"),a(".view_current_playlist").hasClass("mem-hidden")||a(".view_current_playlist").addClass("mem-hidden")))}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}),a(document).on("click","#mem_guest_playlist_form #entry_guest_submit",function(b){var c=document.getElementById("mem_guest_playlist_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(mem_vars.submit_playlist_loading),a(this).prop("disabled",!0),a("#mem_guest_playlist_form_fields").addClass("mem_mute"),a(this).after(' <span id="mem-loading" class="mem-loader"><img src="'+mem_vars.ajax_loader+'" /></span>'),a("input").removeClass("error");var d=a("#mem_guest_playlist_form"),e=a("#mem_guest_playlist_form").serialize();d.find(".mem-alert").hide("fast"),a.ajax({type:"POST",dataType:"json",data:e,url:mem_vars.ajaxurl,success:function(b){b.error?(d.find(".mem-alert-error").show("fast"),d.find(".mem-alert-error").html(b.error),d.find("#"+b.field).addClass("error"),d.find("#"+b.field).focus()):(a(".mem_guest_name_field").is(":visible")&&a(".mem_guest_name_field").slideToggle("fast"),a("#mem-guest-artist").val(""),a("#mem-guest-song").val(""),a("#mem-guest-artist").focus(),a("#guest-playlist-entries").hasClass("mem-hidden")&&a("#guest-playlist-entries").removeClass("mem-hidden"),d.find(".mem-alert-success").show("fast").delay(3e3).hide("fast"),d.find(".mem-alert-success").html(mem_vars.playlist_updated),a("#guest-playlist-entries").append(b.entry),b.closed&&(a("#mem-guest-playlist-input-fields").addClass("mem-hidden"),a("#guest-playlist-entries").append('<div class="mem-alert mem-alert-info">'+mem_vars.guest_playlist_closed+"</div>"))),a("#entry_guest_submit").prop("disabled",!1),a("#mem_guest_playlist_form_fields").find("#mem-loading").remove(),a("#entry_guest_submit").val(mem_vars.submit_guest_playlist),a("#mem_guest_playlist_form_fields").removeClass("mem_mute")}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}}),a(document).on("click",".guest-playlist-delete-entry",function(){var b=a(this).data("event"),c=a(this).data("entry"),d=".mem-playlist-entry-"+c,e={event_id:b,song_id:c,action:"mem_remove_guest_playlist_entry"};a.ajax({type:"POST",dataType:"json",data:e,url:mem_vars.ajaxurl,beforeSend:function(){a("#guest-playlist-entries").addClass("mem_mute"),a(d).addClass("mem_playlist_removing")},complete:function(){a("#guest-playlist-entries").removeClass("mem_mute")},success:function(b){b.success&&a(d).remove()}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}),a(document).on("click","#mem_client_profile_form #update_profile_submit",function(b){var c=document.getElementById("mem_client_profile_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(mem_vars.submit_profile_loading),a(this).prop("disabled",!0),a("#mem_client_profile_form_fields").addClass("mem_mute"),a(this).after(' <span id="mem-loading" class="mem-loader"><img src="'+mem_vars.ajax_loader+'" /></span>'),a("input").removeClass("error");var d=a("#mem_client_profile_form"),e=a("#mem_client_profile_form").serialize();d.find(".mem-alert").hide("fast"),a.ajax({type:"POST",dataType:"json",data:e,url:mem_vars.ajaxurl,success:function(b){b.error?(d.find(".mem-alert-error").show("fast"),d.find(".mem-alert-error").html(b.error),d.find("#"+b.field).addClass("error"),d.find("#"+b.field).focus()):(d.find(".mem-alert-success").show("fast"),d.find(".mem-alert-success").html(mem_vars.profile_updated),a("html, body").animate({scrollTop:a(".mem-alert-success").offset().top},500)),b.password?window.location.href=mem_vars.profile_page:(a("#update_profile_submit").prop("disabled",!1),a("#mem_client_profile_form_fields").find("#mem-loading").remove(),a("#update_profile_submit").val(mem_vars.submit_client_profile),a("#mem_client_profile_form_fields").removeClass("mem_mute"))}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}}),mem_vars.availability_ajax&&a("#mem-availability-check").submit(function(b){if(!a("#availability_check_date").val())return!1;!!b.preventDefault&&b.preventDefault();var c=a("#availability_check_date").val(),d=mem_vars.rest_url;d+="availability/",d+="?date="+c,a.ajax({type:"GET",dataType:"json",url:d,beforeSend:function(){a('input[type="submit"]').hide(),a("#pleasewait").show()},success:function(b){var d=b.data.availability;"available"===d.response?("text"!==mem_vars.available_redirect?window.location.href=mem_vars.available_redirect+"mem_avail_date="+c:(a("#mem-availability-result").replaceWith('<div id="mem-availability-result">'+d.message+"</div>"),a("#mem-submit-availability").fadeTo("slow",1),a("#pleasewait").hide()),a('input[type="submit"]').prop("disabled",!1)):("text"!==mem_vars.unavailable_redirect?window.location.href=mem_vars.unavailable_redirect+"mem_avail_date="+c:(a("#mem-availability-result").replaceWith('<div id="mem-availability-result">'+d.message+"</div>"),a("#mem-submit-availability").fadeTo("slow",1),a("#pleasewait").hide()),a('input[type="submit"]').prop("disabled",!1))}})}),a("#mem-availability-check").validate({rules:{"mem-availability-datepicker":{required:!0}},messages:{"mem-availability-datepicker":{required:mem_vars.required_date_message}},errorClass:"mem_form_error",validClass:"mem_form_valid"})});