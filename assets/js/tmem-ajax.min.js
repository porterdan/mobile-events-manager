function tmem_validate_payment_form(){var a=jQuery('input[type="radio"][name="tmem_payment_amount"]:checked');if(0===a.length)return{msg:tmem_vars.no_payment_amount};if("part_payment"===a.val()){var b=jQuery("#part-payment").val();if(!jQuery.isNumeric(b))return{type:"error",field:"part-payment",msg:tmem_vars.no_payment_amount}}return tmem_vars.require_privacy&&!jQuery("#tmem-agree-privacy-policy").is(":checked")?{type:"error",field:"tmem-agree-privacy-policy",msg:tmem_vars.privacy_error}:tmem_vars.require_terms&&!jQuery("#tmem-agree-terms").is(":checked")?{type:"error",field:"tmem-agree-terms",msg:tmem_vars.terms_error}:{type:"success"}}function tmem_load_gateway(a){jQuery(".tmem-payment-ajax").show(),jQuery("#tmem_payment_form_wrap").html('<img src="'+tmem_vars.ajax_loader+'"/>');var b=tmem_vars.ajaxurl;b+=b.indexOf("?")>0?"&":"?",b=b+"payment-mode="+a,jQuery.post(b,{action:"tmem_load_gateway",tmem_payment_mode:a},function(a){jQuery("#tmem_payment_form_wrap").html(a),jQuery(".tmem-no-js").hide(),jQuery(".tmem-payment-ajax").hide()})}var tmem_vars;jQuery(document).ready(function(a){var b=a(".tmem_datepicker");if(b.length>0){var c=tmem_vars.date_format,d=tmem_vars.first_day;b.datepicker({dateFormat:c,altfield:"#_tmem_event_date",altformat:"yy-mm-dd",firstday:d,changeyear:!0,changemonth:!0})}a(document).on("click",".tmem-scroller",function(b){b.preventDefault();var c=a(this).attr("href");a("html, body").animate({scrollTop:a(c).offset().top},500)}),a("select#tmem-gateway, input.tmem-gateway").change(function(){var b=a("#tmem-gateway option:selected, input.tmem-gateway:checked").val();return"0"!==b&&(tmem_load_gateway(b),!1)}),"1"===tmem_vars.is_payment&&a("select#tmem-gateway, input.tmem-gateway").length&&setTimeout(function(){tmem_load_gateway(tmem_vars.default_gateway)},200),a(document.body).on("click","#tmem-payment-part",function(){a("#tmem-payment-custom").show("fast")}),a(document.body).on("click","#tmem-payment-deposit, #tmem-payment-balance",function(){a("#tmem-payment-custom").hide("fast")}),a(document).on("click","#tmem_payment_form #tmem_payment_submit input[type=submit]",function(b){var c=document.getElementById("tmem_payment_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(tmem_vars.payment_loading),a(this).prop("disabled",!0),a(this).after('<span class="tmem-payment-ajax"><i class="tmem-icon-spinner tmem-icon-spin"></i></span>');var d=tmem_validate_payment_form(c);"success"===d.type?(a(c).find(".tmem-alert").hide("fast"),a(c).find(".error").removeClass("error"),a(c).submit()):(a(c).find(".tmem-alert").show("fast"),a(c).find(".tmem-alert").text(d.msg),d.field&&a("#"+d.field).addClass("error"),a(this).val(tmem_vars.complete_payment),a(this).prop("disabled",!1))}}),a(document).on("click","#tmem_playlist_form #playlist_entry_submit",function(b){var c=document.getElementById("tmem_playlist_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(tmem_vars.submit_playlist_loading),a(this).prop("disabled",!0),a("#tmem_playlist_form_fields").addClass("tmem_mute"),a(this).after(' <span id="tmem-loading" class="tmem-loader"><img src="'+tmem_vars.ajax_loader+'" /></span>'),a("input").removeClass("error");var d=a("#tmem_playlist_form"),e=a("#tmem_playlist_form").serialize();d.find(".tmem-alert").hide("fast"),a.ajax({type:"POST",dataType:"json",data:e,url:tmem_vars.ajaxurl,success:function(b){b.error?(d.find(".tmem-alert-error").show("fast"),d.find(".tmem-alert-error").html(b.error),d.find("#"+b.field).addClass("error"),d.find("#"+b.field).focus()):(a("#tmem_artist").val(""),a("#tmem_song").val(""),a("#tmem_notes").val(""),a("#tmem_artist").focus(),a("#playlist-entries").hasClass("tmem-hidden")&&a("#playlist-entries").removeClass("tmem-hidden"),d.find(".tmem-alert-success").show("fast").delay(3e3).hide("fast"),d.find(".tmem-alert-success").html(tmem_vars.playlist_updated),a("#playlist-entries").append(b.data.row_data),b.data.closed?window.location.href=tmem_vars.playlist_page:(a(".song-count").text(b.data.songs),a(".playlist-length").text(b.data.length),0!==b.data.total&&a(".view_current_playlist").hasClass("tmem-hidden")&&a(".view_current_playlist").removeClass("tmem-hidden"))),a("#playlist_entry_submit").prop("disabled",!1),a("#tmem_playlist_form_fields").find("#tmem-loading").remove(),a("#playlist_entry_submit").val(tmem_vars.submit_playlist),a("#tmem_playlist_form_fields").removeClass("tmem_mute")}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}}),a(document).on("click",".playlist-delete-entry",function(){var b=a(this).data("event"),c=a(this).data("entry"),d=".tmem-playlist-entry-"+c,e={event_id:b,song_id:c,action:"tmem_remove_playlist_entry"};a.ajax({type:"POST",dataType:"json",data:e,url:tmem_vars.ajaxurl,beforeSend:function(){a("#playlist-entries").addClass("tmem_mute"),a(d).addClass("tmem_playlist_removing")},complete:function(){a("#playlist-entries").removeClass("tmem_mute")},success:function(b){b.success&&(a(d).remove(),b.data.count>0?(a(".song-count").text(b.data.songs),a(".playlist-length").text(b.data.length)):(a("#playlist-entries").addClass("tmem-hidden"),a(".view_current_playlist").hasClass("tmem-hidden")||a(".view_current_playlist").addClass("tmem-hidden")))}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}),a(document).on("click","#tmem_guest_playlist_form #entry_guest_submit",function(b){var c=document.getElementById("tmem_guest_playlist_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(tmem_vars.submit_playlist_loading),a(this).prop("disabled",!0),a("#tmem_guest_playlist_form_fields").addClass("tmem_mute"),a(this).after(' <span id="tmem-loading" class="tmem-loader"><img src="'+tmem_vars.ajax_loader+'" /></span>'),a("input").removeClass("error");var d=a("#tmem_guest_playlist_form"),e=a("#tmem_guest_playlist_form").serialize();d.find(".tmem-alert").hide("fast"),a.ajax({type:"POST",dataType:"json",data:e,url:tmem_vars.ajaxurl,success:function(b){b.error?(d.find(".tmem-alert-error").show("fast"),d.find(".tmem-alert-error").html(b.error),d.find("#"+b.field).addClass("error"),d.find("#"+b.field).focus()):(a(".tmem_guest_name_field").is(":visible")&&a(".tmem_guest_name_field").slideToggle("fast"),a("#tmem-guest-artist").val(""),a("#tmem-guest-song").val(""),a("#tmem-guest-artist").focus(),a("#guest-playlist-entries").hasClass("tmem-hidden")&&a("#guest-playlist-entries").removeClass("tmem-hidden"),d.find(".tmem-alert-success").show("fast").delay(3e3).hide("fast"),d.find(".tmem-alert-success").html(tmem_vars.playlist_updated),a("#guest-playlist-entries").append(b.entry),b.closed&&(a("#tmem-guest-playlist-input-fields").addClass("tmem-hidden"),a("#guest-playlist-entries").append('<div class="tmem-alert tmem-alert-info">'+tmem_vars.guest_playlist_closed+"</div>"))),a("#entry_guest_submit").prop("disabled",!1),a("#tmem_guest_playlist_form_fields").find("#tmem-loading").remove(),a("#entry_guest_submit").val(tmem_vars.submit_guest_playlist),a("#tmem_guest_playlist_form_fields").removeClass("tmem_mute")}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}}),a(document).on("click",".guest-playlist-delete-entry",function(){var b=a(this).data("event"),c=a(this).data("entry"),d=".tmem-playlist-entry-"+c,e={event_id:b,song_id:c,action:"tmem_remove_guest_playlist_entry"};a.ajax({type:"POST",dataType:"json",data:e,url:tmem_vars.ajaxurl,beforeSend:function(){a("#guest-playlist-entries").addClass("tmem_mute"),a(d).addClass("tmem_playlist_removing")},complete:function(){a("#guest-playlist-entries").removeClass("tmem_mute")},success:function(b){b.success&&a(d).remove()}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}),a(document).on("click","#tmem_client_profile_form #update_profile_submit",function(b){var c=document.getElementById("tmem_client_profile_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(tmem_vars.submit_profile_loading),a(this).prop("disabled",!0),a("#tmem_client_profile_form_fields").addClass("tmem_mute"),a(this).after(' <span id="tmem-loading" class="tmem-loader"><img src="'+tmem_vars.ajax_loader+'" /></span>'),a("input").removeClass("error");var d=a("#tmem_client_profile_form"),e=a("#tmem_client_profile_form").serialize();d.find(".tmem-alert").hide("fast"),a.ajax({type:"POST",dataType:"json",data:e,url:tmem_vars.ajaxurl,success:function(b){b.error?(d.find(".tmem-alert-error").show("fast"),d.find(".tmem-alert-error").html(b.error),d.find("#"+b.field).addClass("error"),d.find("#"+b.field).focus()):(d.find(".tmem-alert-success").show("fast"),d.find(".tmem-alert-success").html(tmem_vars.profile_updated),a("html, body").animate({scrollTop:a(".tmem-alert-success").offset().top},500)),b.password?window.location.href=tmem_vars.profile_page:(a("#update_profile_submit").prop("disabled",!1),a("#tmem_client_profile_form_fields").find("#tmem-loading").remove(),a("#update_profile_submit").val(tmem_vars.submit_client_profile),a("#tmem_client_profile_form_fields").removeClass("tmem_mute"))}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}}),tmem_vars.availability_ajax&&a("#tmem-availability-check").submit(function(b){if(!a("#availability_check_date").val())return!1;!!b.preventDefault&&b.preventDefault();var c=a("#availability_check_date").val(),d=tmem_vars.rest_url;d+="availability/",d+="?date="+c,a.ajax({type:"GET",dataType:"json",url:d,beforeSend:function(){a('input[type="submit"]').hide(),a("#pleasewait").show()},success:function(b){var d=b.data.availability;"available"===d.response?("text"!==tmem_vars.available_redirect?window.location.href=tmem_vars.available_redirect+"tmem_avail_date="+c:(a("#tmem-availability-result").replaceWith('<div id="tmem-availability-result">'+d.message+"</div>"),a("#tmem-submit-availability").fadeTo("slow",1),a("#pleasewait").hide()),a('input[type="submit"]').prop("disabled",!1)):("text"!==tmem_vars.unavailable_redirect?window.location.href=tmem_vars.unavailable_redirect+"tmem_avail_date="+c:(a("#tmem-availability-result").replaceWith('<div id="tmem-availability-result">'+d.message+"</div>"),a("#tmem-submit-availability").fadeTo("slow",1),a("#pleasewait").hide()),a('input[type="submit"]').prop("disabled",!1))}})}),a("#tmem-availability-check").validate({rules:{"tmem-availability-datepicker":{required:!0}},messages:{"tmem-availability-datepicker":{required:tmem_vars.required_date_message}},errorClass:"tmem_form_error",validClass:"tmem_form_valid"})});